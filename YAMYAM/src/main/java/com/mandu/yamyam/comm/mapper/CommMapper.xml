<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mandu.yamyam.comm.mapper.CommMapper">

<!-- ajax 공통코드 불러오기 -->
<select id="ajaxSelectComm" resultType="com.mandu.yamyam.common.LowerKeyMap">
	
	SELECT COMM_CD, COMM_NM
	FROM C_COMM

</select>

<!-- ajax 상세 공통 코드 불러오기 -->
<select id="ajaxSelectDetailComm" resultType="com.mandu.yamyam.common.LowerKeyMap">
	
	SELECT COMMD_CD, COMMD_NM, COMMD_INFO, COMMD_USE
	FROM C_COMMD
	WHERE COMM_CD = #{commCd}
	
</select>

<!-- 상세 공통 코드 등록 -->

<insert id="ajaxInsertDetailComm" parameterType="com.mandu.yamyam.comm.service.CommdVO">

	INSERT INTO C_COMMD
	(
	COMMD_CD, 
	COMM_CD,
	COMMD_NM,
	COMMD_INFO,
	COMMD_USE
	)
	
	VALUES
	(
	#{commdCd},
	#{commCd},
	#{commdNm},
	#{commdInfo},
	#{commdUse}
	)
	
</insert>

<!-- 상세 공통 코드 삭제 -->

<delete id="ajaxDeleteDetailComm" parameterType="com.mandu.yamyam.comm.service.CommdVO">
	
	DELETE FROM C_COMMD
	WHERE COMMD_CD = #{commdCd}
	
</delete>

<!-- 공통 코드 등록 -->

<insert id="ajaxInsertComm" parameterType="com.mandu.yamyam.comm.service.CommVO">

	INSERT INTO C_COMM
	(COMM_CD, 
	 COMM_NM, 
	 COMM_INFO, 
	 COMM_USE
	 )
	VALUES
	(
	#{commCd},
	#{commNm},
	#{commInfo},
	#{commUse}
	)

</insert>

<!-- 상세 공통 코드, 이름 불러오기(성하) -->

<select id="getCommdCdNm" parameterType="String" resultType="com.mandu.yamyam.common.LowerKeyMap">

	SELECT COMMD_CD, COMMD_NM
	FROM   C_COMMD
	WHERE  COMM_CD = #{value}


</select>

<!-- ajax 자재코드 불러오기 -->
<select id="ajaxSelectMat" resultType="com.mandu.yamyam.common.LowerKeyMap">
	
	SELECT *
	FROM C_MTR
	
</select>

<!-- ajax 거래처 코드(모달) 불러오기 -->
<select id="ajaxSelectModalAct" resultType="com.mandu.yamyam.common.LowerKeyMap">
	
	SELECT ACT_CD, ACT_NM, ACT_NUM, ACT_TEL
	FROM C_ACT
	WHERE ACT_DIV = 'ACT-TYPE2'

</select>

<!--  ajax 자재 - 자재 단건 정보 가져오기 -->

<select id="ajaxSelectMtrInfo" resultType="com.mandu.yamyam.comm.service.MtrVO">
	
	SELECT mtr_cd,
	       act_cd,
	       find_act_name(act_cd) as act_nm,
	       mtr_nm,
	       mtr_std,
	       mtr_un,
	       mtr_sfamt,
	       mtr_sts
	FROM C_MTR
	WHERE MTR_CD = #{mtrCd}
	
</select>

<!-- ajax 거래처 코드 불러오기 -->
<select id="ajaxSelectAct" resultType="com.mandu.yamyam.common.LowerKeyMap">
	
	SELECT *
	FROM C_ACT
	
</select>

<!-- ajax 구매 거래처 등록하기 -->
<insert id="ajaxInsertAct" parameterType="com.mandu.yamyam.comm.service.ActVO">
	
	INSERT INTO C_ACT
	(
	ACT_NM, 
	ACT_CD, 
	ACT_NUM, 
	ACT_TEL, 
	ACT_DIV, 
	ACT_STS
	)
	VALUES
	(
	#{actNm},
	#{actCd},
	#{actNum},
	#{actTel},
	#{actDiv},
	#{actSts}
	)

</insert>

<!-- ajax 완제품코드 불러오기 -->
<select id="ajaxSelectPrd" resultType="com.mandu.yamyam.common.LowerKeyMap">
	
	SELECT * 
	FROM C_PRD
	<where>
	
	<if test = "prdStd !=null and prdStd != ''">
	prd_std = #{prdStd}
	</if>	

	<if test = "prdUn !=null and prdUn != ''">
	prd_un = #{prdUn}
	</if>
	
	<if test = "prdCd !=null and prdCd != ''">
	prd_cd like '%' || Upper(#{prdCd}) || '%'
	</if>
	
	<if test = "prdNm !=null and prdNm != ''">
	prd_nm like '%' || #{prdNm} || '%'
	</if>	
	
	</where> 
</select>

<!-- ajax BOM 불러오기 -->

<select id="ajaxSelectBOM" resultType="com.mandu.yamyam.common.LowerKeyMap">

	SELECT B.BOM_NO, P.PPRO_NAME, B.BOM_CD, B.PRD_CD, B.MTR_CD, C.MTR_NM, B.BOM_AMT, B.BOM_USE
	FROM C_BOM B, P_PRO P, C_MTR C
	WHERE  B.PPRO_CD = P.PPRO_CD
	AND B.MTR_CD = C.MTR_CD
	
</select>

<!-- ajax BOM 제품목록 모달창 불러오기 -->

<select id="ajaxSelectModalBOM" resultType="com.mandu.yamyam.common.LowerKeyMap">

	SELECT PRD_CD, PRD_NM, PRD_STD
	FROM C_PRD
	
</select>
	
</mapper>
